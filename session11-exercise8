import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from PIL import Image

# Load Image
img = Image.open("sample.jpg")
img = np.array(img)

# Reshape into pixel list
pixels = img.reshape(-1, 3)

# Apply KMeans
kmeans = KMeans(n_clusters=8)
kmeans.fit(pixels)

compressed = kmeans.cluster_centers_[kmeans.labels_]
compressed = compressed.reshape(img.shape)

# Display
plt.imshow(compressed.astype("uint8"))
plt.title("Compressed Image")
plt.show()
